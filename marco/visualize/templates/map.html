<!DOCTYPE html>
{% load url from future %}
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <title>
            MARCO Planning Tool
        </title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">
        <!-- Le styles -->
        <link href="{{MEDIA_URL}}/marco/css/bootstrap.css" rel="stylesheet">
        <link href="{{MEDIA_URL}}/marco/css/marco_style.css" rel="stylesheet">
        <link href="{{MEDIA_URL}}/marco-proto/assets/css/scalebar-thin.css" rel="stylesheet">
        <link href="{{MEDIA_URL}}/marco-proto/assets/css/style.css" rel="stylesheet">
        <link href="{{MEDIA_URL}}/marco-proto/assets/css/pageguide.css" rel="stylesheet">

        <link href="{{MEDIA_URL}}/marco/css/smoothness/jquery-ui-1.9.1.custom.css" rel="stylesheet">
        <link href="{{MEDIA_URL}}/marco-proto/assets/css/jquery.mCustomScrollbar.css" rel="stylesheet">
        <link href="{{MEDIA_URL}}marco/css/jquery.jscrollpane.css" rel="stylesheet">
        <!--<link href="{{MEDIA_URL}}/marco-proto/assets/css/jScrollPane.css" rel="stylesheet">-->
        <!--<link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/themes/base/jquery-ui.css"
        type="text/css" media="all" />-->
        <link rel="shortcut icon" href="{{MEDIA_URL}}marco/ico/favicon.ico">

        <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
            <link href="{{MEDIA_URL}}/marco/css/marco_style.ie.css" rel="stylesheet">
            <style>
                    #feedback-tab {
                        -ms-filter: "progid:DXImageTransform.Microsoft.Matrix(M11=-1.836909530733566e-16, M12=-1, M21=1, M22=-1.836909530733566e-16, SizingMethod='auto expand')";
                        left: 0px;

                        /* IE6 and 7 */ 
                        filter: progid:DXImageTransform.Microsoft.Matrix(
                                 M11=-1.836909530733566e-16,
                                 M12=-1,
                                 M21=1,
                                 M22=-1.836909530733566e-16,
                                 SizingMethod='auto expand');

                      }
            </style>
            <script src="{{MEDIA_URL}}marco/js/respond.min.js"></script>
        <![endif]-->
        <!-- Le fav and touch icons -->
        <!--[if IE 7]>
          <link rel="stylesheet" href="{{MEDIA_URL}}marco/css/font-awesome-ie7.css">
        <![endif]-->

        <style>
        .navbar .nav > li:hover > a, .navbar .nav > li.active > a, .navbar .nav > li:hover > a:visited {
            height: 30px;
           
        }
        .navbar .nav > li > a {
            height: 25px;
        }

        </style>
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="{{MEDIA_URL}}/marco-proto/assets/ico/apple-touch-icon-144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="{{MEDIA_URL}}/marco-proto/assets/ico/apple-touch-icon-114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="{{MEDIA_URL}}/marco-proto/assets/ico/apple-touch-icon-72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="{{MEDIA_URL}}/marco-proto/assets/ico/apple-touch-icon-57-precomposed.png">
        
        <!-- Google Analytics -->
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-35841423-1']);
          _gaq.push(['_trackPageview']);

          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();

        </script>
        
        
        <style type="text/css">
            #aggregated-attribute-overlay {
                top: 10px; 
                max-height: 150px; 
                left: auto;
            }
            #aggregated-attribute-overlay {
                position:absolute;
                right:10px;
            }
            #aggregated-attribute-content {
                max-height: 150px; 
            }
            #aggregated-attribute-content .mCustomScrollBox {
                max-height: 150px;
            }
            .olControlScaleBarWrapper {
                display: none;
            }
            #embedded-marco-logo {
                position: absolute;
                top: 10px;
                left: 50px;
                z-index: 800;
                width: 20%;
            }
        </style>
        
        
    </head>
    
    <body>
        
        <div class="container-fluid" id="primary-content">
            <div id="loading">
                <h2>Loading...</h2>
            </div>
            <div class="row-fluid" id="fullscreen">
                <!-- Map Panel -->
                <div id="map-panel" class="span12">       
                
                    <div class="row-fluid" data-bind="visible: showMapPanel">
                        <div class="span12">
                            <div class="row-fluid">
                                <div id="map-wrapper">
                                    <div id="map"></div>
                                    <!-- commenting out the following until a transparent background is generated for the marco logo -->
                                    <!--<a data-bind="attr: { href: mapLinks.getPortalURL() }" target="_blank">
                                        <img id="embedded-marco-logo" src="{{MEDIA_URL}}marco/img/marco-logo_planner.jpg"/>
                                    </a>-->
                                    <div id="aggregated-attribute-overlay-test" style="position: absolute; visibility: hidden; height: auto; width: auto">
                                        <div data-bind="foreach: attributeLayers()">
                                            <div data-bind="css: {display: $root.aggregatedAttributes()[name] ? 'block' : 'none'}">
                                              <h4 data-bind="text: name"></h4>
                                              <dl data-bind="foreach: { data: $root.aggregatedAttributes()[name], afterAdd:$root.updateMarker }">
                                                <dt>
                                                    <span data-bind="text: display"></span><span data-bind="visible: display && data ? true : data===0">:</span>
                                                    <span style="font-weight: normal" data-bind="text: data"></span>
                                                </dt>
                                              </dl>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Aggregated Attribution Overlay -->
                                    <div data-bind="visible: featureAttribution">
                                    <div id="aggregated-attribute-overlay" class="scrollpane" data-bind="visible: aggregatedAttributes, style: {width: aggregatedAttributesWidth}" style="display: none">
                                        <div id="aggregated-attribute-content">
                                          <div data-bind="foreach: attributeLayers()">
                                            <div data-bind="visible: $root.aggregatedAttributes()[name]">
                                              <h4 data-bind="text: name"></h4>
                                              <dl data-bind="foreach: { data: $root.aggregatedAttributes()[name], afterAdd:$root.updateMarker }">
                                                <dt>
                                                    <span data-bind="text: display"></span><span data-bind="visible: display && data ? true : data===0">:</span>
                                                    <span style="font-weight: normal" data-bind="text: data"></span>
                                                </dt>
                                              </dl>
                                            </div>
                                          </div>
                                        </div>
                                        <span id="close-attribute-overlay" class="pull-right"><a href="#" style="position: absolute; top: 10px; right: 10px; opacity: .6;" class="btn btn-mini close" data-bind="click: closeAttribution"> x </a> </span>
                                    </div>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>    
            </div>
            <span class="timestamp" data-bind="visible: mapTitle"><span data-bind="text: new Date().toString('M/d/yyyy HH:mm')"></span></span>
        </div>

        <!--/row-->
          
        <!--/.fluid-container-->

        
        <!--<link rel="stylesheet" type="text/css" href="http://www.transportparadise.co.uk/layerswitcher/layerswitcher.css" />
        <link rel="stylesheet" type="text/css" src="{{MEDIA_URL}}/marco-proto/assets/css/simplelayerswitcher.css" />-->
        <script src="{{MEDIA_URL}}/marco/js/jquery.js"></script>
        <script src="{{MEDIA_URL}}/marco/js/bootstrap.min.js"></script>
        <script src="{{MEDIA_URL}}/marco/js/amplify.min.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/jquery.ba-bbq.js"></script>
        <script src="{{MEDIA_URL}}/marco/js/jquery-ui-1.9.1.custom.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/knockout-2.1.0.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/knockout-bindings.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/knockout.mapping-latest.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/jquery.pageguide.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/highcharts.js" type="text/javascript"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/highcharts-more.js" type="text/javascript"></script>
     <!-- <script src="http://maps.google.com/maps/api/js?v=3.5&amp;sensor=false"></script>-->
        <script src="http://maps.google.com/maps/api/js?v=3.6&amp;sensor=false"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/openlayers/OpenLayers.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/simplelayerswitcher.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/scalebar.js"></script>
        <script src="{{MEDIA_URL}}/marco/js/bigscreen.js"></script>
        <script src="{{MEDIA_URL}}/marco/js/jquery.ui.touch-punch.min.js"></script>
        <script src="{{MEDIA_URL}}/marco/js/jquery.jscrollpane.min.js"></script>
        <script src="{{MEDIA_URL}}/marco/js/date.js"></script>


        <script src="{{MEDIA_URL}}/marco-proto/fixtures.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/map.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/state.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/models.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/server.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/printing.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/app.js"></script>
        <script src="{{MEDIA_URL}}/marco-proto/pageguide.js"></script>

        <!--[if gt IE 8]><!-->
        <script src="{{MEDIA_URL}}/marco-proto/assets/js/jquery.mousewheel.min.js"></script>
        <!--<![endif]-->

        <script src="{{MEDIA_URL}}/marco-proto/assets/js/jquery.mCustomScrollbar.js"></script>
        
        <script type="text/javascript">
            $('#aggregated-attribute-overlay').on('show', function(e) {
                console.log('on show');
                app.viewModel.hideMapAttribution();
            });
        </script>
        
        
    </body>

</html>                