<!DOCTYPE html>
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <title>
            MARCO Planning Tool
        </title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">
        <!-- Le styles -->
        <link href="{{media}}/marco/css/bootstrap.css" rel="stylesheet">
        <link href="{{media}}/marco/css/marco_style.css" rel="stylesheet">

        <link href="{{media}}/marco-proto/assets/css/style.css" rel="stylesheet">
        <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.21/themes/base/jquery-ui.css"
        type="text/css" media="all" />
        <link rel="shortcut icon" href="{{MEDIA_URL}}marco/ico/favicon.ico">

        <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js">
                                    
            </script>
        <![endif]-->
        <!-- Le fav and touch icons -->
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="{{media}}/marco-proto/assets/ico/apple-touch-icon-144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="{{media}}/marco-proto/assets/ico/apple-touch-icon-114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="{{media}}/marco-proto/assets/ico/apple-touch-icon-72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="{{media}}/marco-proto/assets/ico/apple-touch-icon-57-precomposed.png">
    </head>
    
    <body>
        <header role="banner">
            <div class="navbar navbar-fixed-top">
              <div class="navbar-inner">
                <div class="container-fluid">
                    <a href="/portal">
                        <img src="{{media}}marco/img/marco-logo.gif"/>
                    </a>
                  <div class="pull-right">
                    <ul class="nav">
                      <li class=""><a a href="/portal">Return to Portal</a></li>
                      <li class=""><a href="">Help</a></li>
                    </ul>
                  </div><!--/.nav-collapse -->
                </div>
              </div>
            </div>
        </header> <!-- end header -->
        {% include "feedback.html" %}  
        <div class="container-fluid" id="primary-content">
            <div class="row-fluid"   id="fullscreen">
                <div class="span4 frame tabs">
                    <div class="sidebar-nav">
                        <!-- tab controls -->
                        <ul id="myTab" class="nav nav-tabs">
                            <li class="active">
                                <a href="#data" data-toggle="tab" id="dataTab">Data</a>
                            </li>
                            <!--<li>
                                <a href="#designs" data-toggle="tab">Designs</a>
                            </li>-->
                            <li>
                                <a href="#active" data-toggle="tab" id="activeTab">Active  
                                    <span data-bind="visible: activeLayers().length > 0">
                                        (<span  data-bind="text: activeLayers().length">0</span>)
                                    </span>
                                </a>
                            </li>
                            
                        </ul>
                        <!-- tab body -->
                        <div id="myTabContent" class="tab-content">
                            <!-- data tab -->
                            <div class="tab-pane fade active in" id="data">
                                <div class="row-fluid">
                                    <div class="span12 ">
                                        <form class="form-search" data-bind="submit: layerSearch">
                                            <div class="span12">
                                                <input type="text" class="search-box" data-provide="typeahead" data-bind="value: searchTerm, event: { keyup: keySearch }">
                                                <i class="icon-remove-sign icon-large"></i> 
                                                <a type="submit" class="btn">
                                                    Search
                                                </a>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="row-fluid">
                                        <div class="span12">
                                            <!-- data accordion -->
                                            <div id="data-accordion">
                                                <div class="accordion" data-bind="foreach: themes">
                                                    <div class="accordion-group">
                                                        <div class="accordion-heading" data-bind="event: {'mouseenter': $root.hideTooltip}, css: { 'active': isOpenTheme() }">
                                                            <div>
                                                                <a class="accordion-toggle"  data-bind="click: setOpenTheme"> <!--event: {'hover': showDescription}-->

                                                                    <span data-bind="text: name">Themes</span></a>

                                                            </div>
                                                        </div>
                                                        <div class="accordion-body collapse" data-bind="css: { 'in': isOpenTheme() }">
                                                            <div class="accordion-inner">
                                                                <ul  class="unstyled" data-bind="foreach: layers ">
                                                                    <li class="layer" data-bind="css: { nosublayers: subLayers.length === 0 } ">
                                                                        <div class="btn-group btn-group-layer" data-bind="css: {'open': showSublayers() }">
                                                                            <a class="btn btn-info-sign" data-bind="click: showDescription">
                                                                                <i class="icon-info-sign icon-large"></i>
                                                                            </a>

                                                                            <a class="btn btn-layer" data-bind="css: { 'active': active() }, click: toggleActive">
                                                                                <div>
                                                                                    <span data-bind="visible: ! activeSublayer()">
                                                                                        <span data-bind="text: name"></span>
                                                                                    </span>
                                                                                    <span data-bind="visible: activeSublayer">
                                                                                        <span data-bind="text: activeSublayer().name"></span>
                                                                                    </span>
                                                                                    <span class="caret" style="display:none" data-bind="visible: subLayers.length > 0"></span>
                                                                                    <i class="check icon-large icon-check" data-bind="css: { 'icon-check': active() && visible(), 
                                                                                                                                     'icon-check-empty': active() && ! visible()}">
                                                                                    </i>
                                                                                </div>
                                                                            </a>

                                                                            <!-- ko if: subLayers.length > 0 -->
                                                                            <ul class="dropdown-menu layer-menu" data-bind="event: { mouseleave: closeMenu }">
                                                                                <li data-bind="foreach: subLayers">
                                                                                    <a data-bind="click: toggleActive">
                                                                                        <span data-bind="style: {visibility: active() ? 'visible': 'hidden' }">â€¢ </span>
                                                                                        <span data-bind="text: name"></span>
                                                                                    </a>
                                                                                </li>
                                                                            </ul>
                                                                            <!-- /ko -->
                                                                        </div>
                                                                    </li>  
                                                                </ul>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- /data-accordion -->
                                        </div>
                                    </div>
                                    <!-- /span -->
                                </div>
                                <!-- /row -->
                            </div>
                            <!-- /data-tab -->
                            <!-- design tab -->
                            <div class="tab-pane fade" id="designs">
                                <p>
                                    designs
                                </p>
                            </div>
                            <!-- /design-tab -->
                            <!-- active layer tab -->
                            <div class="tab-pane fade" id="active">
                                <div class="row-fluid">
                                    <div class="span12">
                                        <div data-bind="visible: activeLayers().length === 0">
                                            <div style="padding: 10px;">
                                                <p>
                                                    You currently have no activated data layers. 
                                                </p>
                                                <p>
                                                    Any layers that are activated in the Data panel will also appear in this Active panel.
                                                </p>
                                                <p>
                                                    Layers in the Active panel can be adjusted in terms of their transparency and their ordering on the map.
                                                </p>
                                            </div>
                                        </div>
                                        <ul class="unstyled" data-bind="sortable: { data: activeLayers, options: {  } }">
                                            <li>
                                                <div class="btn-group">
                                                    <button class="btn btn-info-sign"><i class="icon-info-sign icon-large" data-bind="click: showDescription"></i></button>
                                                    <a class="btn btn-layer" data-bind="css: { 'active': visible() }, click: toggleVisible">
                                                        <div data-bind="text: name"></div>
                                                        <div><i class="icon-large check" data-bind="css: { 'icon-check': visible(), 'icon-check-empty': ! visible() }"></i></div>
                                                    </a>
                                                    <a class="btn opacity-button" data-bind="click: $parent.showOpacity"><i class="icon-adjust icon-large"></i></a>
                                                    <a class="btn" data-bind="click: toggleActive">
                                                        <i class="icon-remove">
                                                        </i>
                                                    </a>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <!-- /active-tab -->
                        </div>

                    </div>
                </div>
                <!--/span-->
                <div class="span8">       
                    <div class="row-fluid" data-bind="visible: showMapPanel">
                        <div class="span12">
                            <div class="row-fluid">
                                <div id="map-wrapper" data-bind="css: { span9: showLegend(), span12: ! showLegend() }">
                                  <div id="map"></div>
                                  <div id="basemaps"> <!-- Basemaps, Legends, Bookmarks, and FullScreen buttons -->
                                    <div class="btn-group btn-group-vertical">
                                      <a id="basemap-button" class="btn" data-bind="click: showBasemaps">
                                          <i class="icon-globe icon-large"></i>
                                          <span>Basemaps</span>
                                      </a>
                                      <a class="btn" data-bind="click: toggleLegend, attr: {disabled: ! hasActiveLegends()}">
                                        <i class="icon-list-ul icon-large"></i> 
                                      <span data-bind="text: legendButtonText()"></span>
                                      <span data-bind="visible: hasActiveLegends() > 0"> (<span data-bind="text: activeLegendLayers().length"></span>) </span>
                                     </a>
                                      <a id="bookmarks-button" class="btn" data-bind="click: showBookmarks">
                                          <i class="icon-flag icon-large"></i>
                                          <span>Bookmarks</span>
                                         <span data-bind="visible: bookmarks.bookmarksList().length > 0">
                                              (<span data-bind="text: bookmarks.bookmarksList().length"></span>)
                                          </span>
                                      </a>
                                      <a class="btn" id="btn-fullscreen">
                                        <i class="icon-fullscreen icon-large"></i>
                                        <span>Fullscreen</span>
                                    </a>
                                  </div>
                                  </div>
                                  <div id="map-buttons">
                                    <!--   <p><a class="btn pull-right">
                                          Coordinates &amp; Depth
                                      </a></p> -->
                                  </div>
                                  
                                  <!-- Attribution Overlay -->
                                  <div id="attribute-data">
                                    <div data-bind="visible: attributeData" style="display: none">
                                      <span class="pull-right"><a href="#" style="margin-left: 10px; opacity: .6;" class="btn btn-mini close" data-bind="click: closeAttribution"> x </a> </span>
                                      <dl>
                                        <dt><span data-bind="text: attributeTitle()"></span></dt>
                                        <dl data-bind="foreach: attributeData()">
                                            <dt data-bind="text: display"></dt>
                                            <dd data-bind="text: data"></dd>
                                        </dl>
                                      </dl>
                                    </div>
                                  </div>
                                  
                                  <!-- Bookmark Message -->
                                  <div id="error-overlay" data-bind="visible: error() === 'restoreState'" style="display:none">
                                        <div>
                                            Bookmark "<span data-bind="text: activeBookmark"></span>"
                                            <div class="pull-right">
                                                <a href="#" style="margin-left: 10px; opacity: .6;" class="close btn btn-mini" data-bind="click: closeAlert"> x </a>
                                                <a class="btn btn-mini" data-bind="click: bookmarks.restoreState">
                                                    Return to Previous View
                                                </a>
                                            </div>
                                        </div>
                                  </div>
                                  
                                  <!-- Description Overlay  style="display:none"-->
                                    <div id ="description-overlay" class="row-fluid" style="display: none">
                                        <div class="span11">
                                            <span class="title" data-bind="text: activeName"></span> -- 
                                            <span class="text" data-bind="text: activeText"></span>
                                            <span class="text">
                                                <a class="btn btn-info btn-mini" data-bind="visible: activeLearnLink(), attr: { href: activeLearnLink }" target="_blank">Learn More...</a>
                                            </span>  
                                        </div>
                                        <div class="span1">
                                            <a href="#" style="margin-left: 10px; opacity: .6;" class="btn btn-mini close" data-bind="click: closeDescription"> x </a> 
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Legends panel -->
                                <div data-bind="visible: showLegend()" class="span3">
                                    <div id="legend-wrapper">
                                        <span class="pull-right">
                                            <a href="#" style="margin-left: 10px; margin-top: 5px; opacity: .6;" class="btn btn-mini close" data-bind="click: toggleLegend"> x </a> 
                                        </span>
                                        <h3>Legends</h3>
                                        <hr/>
                                        <div data-bind="foreach: activeLegendLayers">
                                                <div style="padding-bottom: 10px;">
                                                    <span class="pagination-centered" data-bind="html: legendTitle ? legendTitle : name"></span>
                                                    <span data-bind="if: legend">
                                                        <div data-bind="css: { 'in': legendVisibility }" style="padding-top: 5px;">
                                                            <img data-bind="attr: { src: legend }" />
                                                        </div>
                                                    </span>
                                                </div>
                                            </div>
                                          </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--/row-->
            </div>
            <!--/span-->
        </div>
        <!--/row-->
        <hr>
          
        <!--/.fluid-container-->
        
        <!-- transparency tool -->
        <div style="display:none" id="opacity-popover" class="popover fade bottom in">
            <div class="arrow">
            </div>
            <div class="popover-inner">
                <div class="popover-content" data-bind="if: selectedLayer">
                    <div class="slider" data-bind="jqSlider: selectedLayer().opacity, jqOptions: { min: 0, max: 1, step: .01, range: 'min' }"></div>                    
                </div>
            </div>
        </div>
        
        <div style="display:none" id="layer-popover" class="layer-popover popover fade right in" data-bind="event: {'mouseleave': $root.hideTooltip}">
            <div class="arrow"></div>
            <div class="popover-inner layer-tooltip">
                <div class="popover-content">
                    <span data-bind="html: layerToolTipText"></span>
                </div>
            </div>
        </div>
        <div style="display:none" id="bookmark-popover" class="popover fade left in" data-bind="with: bookmarks">
            <div class="arrow">
            </div>
            <div class="popover-inner">
                <h3 class="popover-title">
                    Bookmarks
                </h3>
                <div class="popover-content">
                    <p>
                        <div>
                            <div>
                                <div>
                                    <div id="bookmarks-table">
                                        <table class="table table-condensed">
                                            <tbody data-bind="foreach: bookmarksList">
                                                <tr>
                                                    <td>
                                                        <span data-bind="click: $parent.loadBookmark">
                                                        <a data-bind="text: name, attr: {href: $parent.getUrl($data)}">name</a>
                                                        </span>
                                                    </td>
                                                    <td class="tweet-cell">
                                                        <a href="https://twitter.com/share" class="twitter-share-a" data-bind="attr: {'data-url': $parent.getUrl($data)}"
                                                        data-lang="en" data-size="medium" data-count="none">Tweet</a>
                                                        <script>
                                                            ! function(d, s, id) {
                                                                var js, fjs = d.getElementsByTagName(s)[0];
                                                                if (!d.getElementById(id)) {
                                                                    js = d.createElement(s);
                                                                    js.id = id;
                                                                    js.src = "//platform.twitter.com/widgets.js";
                                                                    fjs.parentNode.insertBefore(js, fjs);
                                                                }
                                                            }(document, "script", "twitter-wjs");
                                                        </script>
                                                    </td>
                                                    <!--
                                                    <td>
                                                        <a class="btn btn-mini tweet-trash" data-bind="click: $parent.emailBookmark">
                                                            <a data-bind="attr: {href: $parent.getEmailHref($data)}">
                                                            <i class="icon-envelope">
                                                            </i>
                                                            </a>
                                                        </a>
                                                    </td>
                                                    -->
                                                    <td>
                                                        <a class="btn btn-mini tweet-trash" data-bind="click: $parent.removeBookmark">
                                                            <i class="icon-trash icon-large">
                                                            </i>
                                                        </a>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p data-bind="visible: bookmarksList().length === 0">
                                            Bookmarks save the map and active layers. You currently have no bookmarks.
                                        </p>
                                    </div>
                                </div>
                                <hr/>
                                <h5>
                                    Create new bookmark
                                </h5>
                                <form data-bind="submit: saveBookmark">
                                    <input type="text" data-bind="value: bookmarkName" class="input">
                                    <div class="pull-right">
                                        <button data-bind="click: cancel" class="btn btn-mini">cancel</button>
                                        <button class="btn btn-mini" type="submit">
                                            save
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </p>
                </div>
            </div>
        </div>
        <!-- Le javascript -->
        <!-- Placed at the end of the document so the pages load faster -->
        <!-- <script src="assets/js/bootstrap-transition.js"></script>
    <script src="assets/js/bootstrap-alert.js"></script>
   
    <script src="assets/js/bootstrap-scrollspy.js"></script>
    <script src="assets/js/bootstrap-a.js"></script>
    <script src="assets/js/bootstrap-carousel.js"></script>
    <script src="assets/js/bootstrap-collapse.js"></script>
     -->
        <!--<link rel="stylesheet" type="text/css" href="http://www.transportparadise.co.uk/layerswitcher/layerswitcher.css" />
        <link rel="stylesheet" type="text/css" src="{{media}}/marco-proto/assets/css/simplelayerswitcher.css" />-->
        <script src="{{media}}/marco/js/jquery.js"></script>
        <script src="{{media}}/marco/js/bootstrap.min.js"></script>

        <script src="{{media}}/marco-proto/assets/js/jquery.ba-bbq.js"></script>
        <script src="{{media}}/marco-proto/assets/js/jquery-ui.js"></script>
        <script src="{{media}}/marco-proto/assets/js/knockout-2.1.0.js"></script>
        <script src="{{media}}/marco-proto/assets/js/knockout-bindings.js"></script>
        <script src="{{media}}/marco-proto/assets/js/knockout.mapping-latest.js"></script>
     <!-- <script src="http://maps.google.com/maps/api/js?v=3.5&amp;sensor=false"></script>-->
        <script src="http://maps.google.com/maps/api/js?v=3.6&amp;sensor=false"></script>
        <script src="{{media}}/marco-proto/assets/openlayers/OpenLayers.js"></script>
        <script src="{{media}}/marco-proto/assets/js/simplelayerswitcher.js"></script>
        <script src="{{media}}/marco/js/bigscreen.js"></script>
        <script src="{{media}}/marco/js/jquery.ui.touch-punch.min.js"></script>
        <!--<script src="http://www.transportparadise.co.uk/layerswitcher/simplelayerswitcher.js"></script>-->
        <script>
            var app = {};
        </script>
        <script src="{{media}}/marco-proto/fixtures.js"></script>
        <script src="{{media}}/marco-proto/map.js"></script>
        <script src="{{media}}/marco-proto/state.js"></script>
        <script src="{{media}}/marco-proto/models.js"></script>
        <script src="{{media}}/marco-proto/server.js"></script>
        <script src="{{media}}/marco-proto/app.js"></script>
        <script>
        !
function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (!d.getElementById(id)) {
        js = d.createElement(s);
        js.id = id;
        js.src = "//platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js, fjs);
    }
}(document, "script", "twitter-wjs");
        </script>
    </body>

</html>